#!/usr/bin/env bash
#
# Original source: https://github.com/matthewmccullough/scripts/blob/master/git-finddirty

IFS=$'\n'

fail() {
  echo "$@"
  exit 1
}

for gitprojpath in $(find . -type d -name .git | sort | sed "s/\/\.git//"); do
  pushd . > /dev/null
  cd "$gitprojpath" || fail "could not $gitprojpath"
  isdirty=$(git status -s | grep "^.*")
  if [ -n "$isdirty" ]; then
    echo "DIRTY:" "$gitprojpath"
  fi
  popd > /dev/null
done
